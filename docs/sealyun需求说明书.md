## sealyun需求说明书



> sealyun主要服务于sealos的软件包，已订阅服务作为基本，用户可以自助通过sealyun进行订阅服务下载对应服务的软件包进行使用。



## 页面模块



### 主页

- **突出展示平台的说明，主要的意义 （感觉不合理可提意见）**

- 订阅服务按钮可正常跳转到服务中心模块。

- Github地址目前跳转到sealos的github

- 导航顺序  未登录：（主页、软件市场、说明文档、评论说明），已登录：（主页、软件市场、服务中心、说明文档、评论说明、我的产品）

- 头像下面三个标题（用户设置、后台管理、退出登录）

  - 后台管理（判断用户角色，如果是普通用户则不显示这个模块）
  - 退出登录后清空session，需要重新登录

  

  



## 用户模块

#### 登录

 目前仅支持github登录，所以user表只要用户一旦登录，自从插入user表数据。读取github的api获取username,emial和avatar_url字段。**邮箱只有创建时会自动同步，已经存在的数据不会修改邮箱。**

- 数据库表 `user` 表
  - name  ()
  - email
  - phone 后台自行维护
  - alipay 预留字段
  - alipay_pwd 预留字段
  - avatar_url 头像
  - site_role  ： 1 普通用户 2 平台管理员 3 文档管理员
  - amount 预留字段

#### 个人中心

仅支持修改 邮箱、手机号、支付宝账号、支付宝体现密码。



## 评论模块



> 这个模块是从以前的系统迁移过来的，正常展示即可。



## 文档模块



### 前台展示

根据后台维护的数据展示数据 

https://market.cuisongliu.com/instructions

https://market.cuisongliu.com/marketctl

### 后台管理

> 对于非普通用户可在后台管理操作文档模块。

数据库： markdown_type,markdown_content

#### 文档管理 【文档类别】

目前内置2类文档usage和marketctl。（针对文档无权限控制）

- 可创建自定义类型（对于无内容的类型可以删除）对于默认（usage和marketctl无法删除）
- 若删除类型确认数据库是否真实删除
- 对接的类别接口 （/api/v2/usage/type/:type）
- 菜单显示： 文档管理 
- 【文档类别】显示标题 （序号、类别路径（提示：对接地址：/api/v2/usage/type/:type）、文档描述，操作【修改】【删除】）
  - 创建、修改、删除 弹窗提示与当前功能模块一致。【新建/创建】文档类别
  - 创建时类别路径不能重复且只能为英文
  - 修改只能改描述，不能改名称
  - 删除和修改都需要二次检查【注意提示信息】
- 点击类型路径进入文档内容模块【注意文案一致性】
  - 【文档管理】-【文档内容】 ？？？

#### 文档内容

> 由文档管理点击进入

- 表格表头 （序号、文档标题、排序、操作【预览/查看、修改，删除】）
- 根据排序字段进行升序排序
- 创建文档需要跟文档类别关联（查看数据库）
- 标题不限制格式，内容支持markdwon
- 弹窗标题注意文本一致性
- 文档字段【文档标题、排序、文档内容】
- 敏感操作需要二次检查
- 头部需要展示对接地址【位置自己看感觉哪里比较合适】（提示：对接地址：/api/v2/usage/content/:id）





## 授权应用



> 文案合理即可

- 系统默认有个system的的操作令牌（不能删除）
- 生成令牌只要显示一次即可，显示后没有入口查询token。
- 拿到令牌信息可用于[marketctl](https://github.com/sealyun-market/marketctl/releases/tag/v1.0.5)操作
- marketctl和网站操作需要幂等


 
## 我的产品

> 每个用户都可以接入到sealyun，需要到我的产品自行上传产品信息。

**文案可以调整**

### 产品信息

- 用户可自行创建产品，创建完的产品状态为**已提交**，主页无信息显示。需要管理员审核并修改状态为上线才可以在页面看到信息。
- 产品名称输入框为模糊搜索，产品类型为下拉。
- 当前页面分页展示
- 对于已经上线的产品不能进行删除操作，只能修改。已提交状态的产品可以删除和修改操作。
- 产品名称可跳转到  我的产品 - 产品版本 并联带搜索条件，相当于查询当前产品下的所有版本。

### 产品版本（产品下所有的版本数据）

- 查询中**产品类型和产品名称均为下拉**，产品名称只能看到当前用户上传的产品，不允许看到其他用户的产品。
- 搜索产品版本也是查询当前用户的产品对应的产品版本。
- 操作按钮：用户可对产品版本进行【修改、下载、删除、上线、下线操作】（目前只支持marketctl上线版本，不支持页面，自己的产品才可以上线版本）
- 价格字段可去掉（目前只有VIP，这个字段意义不大）
- 修改状态同步首页的软件市场

## 软件市场

> 左侧云内核等信息是显示的产品类别,类别下有对应的产品信息.

- 所有的搜索均为模糊搜索。
- 显示产品信息相关信息，列出所有的产品版本。（版本下载这块是跳转到服务中心，看看文案是否调整一下）

## 服务中心

> 管理员可以定义服务（服务名称、服务时长、服务费用）

- 页面显示所有的服务，若已付费屏蔽购买按钮，直接显示服务产品。（若付费服务产品有下载地址，否则没有）
- 点购买服务弹出付款链接支付宝付款。（付款有效期2h）正常付款后是否能及时同步服务状态。
- 进入对应的服务中心下拉框联动查询，并可以正常下载软件包。
- 只显示已上线的商品。



## 管理员功能



### 产品类型

- 可直接创建产品类别，产品描述展示在首页类别信息的标题上。（看看是否合理）
- 对于已经有产品信息的产品类型不能进行删除操作。
- 点击名称链接跳转到产品信息【切记，是管理员的产品信息】中。并附带信息查询。

### 产品信息

- 需要展示字段： 产品类型、产品名称、排序、简介、创建时间和所属用户
- 搜索产品类型、产品名称、所属用户。
- 所有状态的产品可点击链接【所有状态的产品】跳转到产品版本【切记，是管理员的产品版本】中，并附带查询信息。
- 已经上线的不能进行删除操作，已经存在产品版本的不能进行删除（后端校验）。用户可以设置任何状态给产品信息。

### 产品版本

- 可隐藏产品价格字段，修改只修改排序字段。可修改下载地址。
- 搜索只需要联动即可，跟个人信息无关。
- 修改、下载、修改状态和删除都可操作。

